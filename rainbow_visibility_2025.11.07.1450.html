<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <title>Rainbow Visibility Explorer</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="https://unpkg.com/maplibre-gl@3.6.1/dist/maplibre-gl.css" rel="stylesheet" />
    <style>
        body { margin: 0; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; background: #0f172a; color: #e2e8f0; }
        #map { position: absolute; inset: 0; }
        .info-panel {
            position: absolute;
            top: 12px;
            left: 12px;
            padding: 12px 14px;
            border-radius: 8px;
            background: rgba(15, 23, 42, 0.85);
            box-shadow: 0 4px 18px rgba(0, 0, 0, 0.35);
            backdrop-filter: blur(6px);
            max-width: 320px;
            font-size: 14px;
            line-height: 1.45;
        }
        .info-panel h1 {
            font-size: 16px;
            margin: 0 0 6px 0;
            color: #f472b6;
        }
        .info-panel kbd {
            font-size: 12px;
            background: rgba(148, 163, 184, 0.2);
            border-radius: 4px;
            padding: 2px 6px;
            margin-left: 4px;
        }
        .legend {
            display: flex;
            flex-wrap: wrap;
            gap: 6px 12px;
            margin-top: 8px;
        }
        .legend-item {
            display: flex;
            align-items: center;
            gap: 6px;
        }
        .swatch {
            width: 14px;
            height: 14px;
            border-radius: 50%;
            border: 1px solid rgba(15, 23, 42, 0.7);
        }
        .swatch.sun { background: #facc15; }
        .swatch.zone { background: linear-gradient(90deg, #34d399, #f472b6); border-radius: 2px; width: 28px; }
        .swatch.edge { background: #0ea5e9; border-radius: 2px; width: 20px; }
    </style>
</head>
<body>
    <div id="map"></div>
    <div class="info-panel" id="info-panel"></div>
    <script src="https://unpkg.com/maplibre-gl@3.6.1/dist/maplibre-gl.js"></script>
    <script>
        const geojson = {"type": "FeatureCollection", "features": [{"type": "Feature", "geometry": {"type": "Point", "coordinates": [-87.67259, 42.054788]}, "properties": {"kind": "fountain", "label": "Fountain 1"}}, {"type": "Feature", "geometry": {"type": "Polygon", "coordinates": [[[-87.67258441189817, 42.05479499857716], [-87.67258415747693, 42.05479488221041], [-87.67258390741561, 42.05479476070792], [-87.6725836619008, 42.05479463416032], [-87.67258342111572, 42.05479450266208], [-87.67258318524006, 42.05479436631128], [-87.67258295444982, 42.05479422520972], [-87.67258272891723, 42.05479407946267], [-87.6725825088106, 42.05479392917889], [-87.6725822942942, 42.05479377447054], [-87.67258208552806, 42.05479361545307], [-87.67258188266801, 42.05479345224513], [-87.67258168586541, 42.05479328496853], [-87.67258149526714, 42.05479311374808], [-87.6725813110154, 42.05479293871157], [-87.67258113324775, 42.054792759989596], [-87.67258096209676, 42.05479257771554], [-87.67258079769022, 42.05479239202541], [-87.67258064015078, 42.054792203057815], [-87.67258048959603, 42.05479201095372], [-87.67258034613828, 42.05479181585651], [-87.67258020988461, 42.054791617911754], [-87.6725800809367, 42.0547914172672], [-87.67257995939075, 42.05479121407253], [-87.67258083797778, 42.054790932830436], [-87.67258094888805, 42.05479111824488], [-87.6725810665526, 42.05479130133238], [-87.67258119088362, 42.0547914819563], [-87.67258132178831, 42.05479165998185], [-87.67258145916904, 42.05479183527619], [-87.67258160292324, 42.0547920077085], [-87.67258175294367, 42.054792177150105], [-87.67258190911836, 42.05479234347456], [-87.67258207133077, 42.05479250655775], [-87.67258223945984, 42.054792666278], [-87.67258241338014, 42.05479282251608], [-87.67258259296185, 42.05479297515542], [-87.67258277807096, 42.054793124082124], [-87.67258296856936, 42.054793269185026], [-87.67258316431487, 42.05479341035587], [-87.67258336516142, 42.05479354748931], [-87.67258357095915, 42.054793680482994], [-87.67258378155447, 42.054793809237715], [-87.67258399679022, 42.05479393365734], [-87.6725842165058, 42.05479405364906], [-87.67258444053724, 42.05479416912331], [-87.67258466871735, 42.05479427999394], [-87.67258490087588, 42.05479438617819], [-87.67258441189817, 42.05479499857716]]]}, "properties": {"kind": "view-zone", "height": 2.0, "label": "Fountain 1", "radiusMin": 0.8254305510918294, "radiusMax": 0.9045847512574479, "bearing": 48.755391838982234}}, {"type": "Feature", "geometry": {"type": "Polygon", "coordinates": [[[-87.67256345650539, 42.05482124323898], [-87.67256224800421, 42.05482069049676], [-87.67256106021264, 42.05482011335965], [-87.67255989401707, 42.054819512258355], [-87.67255875028773, 42.0548188876414], [-87.67255762987814, 42.054818239974935], [-87.67255653362439, 42.05481756974225], [-87.67255546234452, 42.05481687744352], [-87.67255441683798, 42.05481616359535], [-87.67255339788498, 42.05481542873044], [-87.67255240624587, 42.05481467339719], [-87.67255144266066, 42.05481389815924], [-87.67255050784844, 42.05481310359511], [-87.67254960250676, 42.05481229029774], [-87.67254872731124, 42.054811458874035], [-87.67254788291498, 42.05481060994442], [-87.67254706994811, 42.05480974414244], [-87.67254628901728, 42.05480886211416], [-87.67254554070524, 42.05480796451778], [-87.67254482557044, 42.054807052023136], [-87.67254414414653, 42.054806125311174], [-87.67254349694198, 42.054805185073405], [-87.67254288443982, 42.05480423201151], [-87.67254230709706, 42.05480326683668], [-87.67254648038696, 42.05480193093805], [-87.67254700721034, 42.05480281165683], [-87.67254756611656, 42.054803681322596], [-87.67254815668858, 42.054804539286366], [-87.67254877848565, 42.05480538490792], [-87.67254943104379, 42.0548062175562], [-87.67255011387603, 42.05480703660986], [-87.67255082647283, 42.05480784145768], [-87.6725515683024, 42.05480863149906], [-87.67255233881117, 42.05480940614446], [-87.67255313742416, 42.05481016481578], [-87.67255396354541, 42.05481090694687], [-87.67255481655846, 42.05481163198395], [-87.67255569582673, 42.05481233938596], [-87.67255660069408, 42.054813028625], [-87.67255753048528, 42.05481369918673], [-87.67255848450648, 42.054814350570766], [-87.67255946204575, 42.05481498229101], [-87.67256046237361, 42.054815593876064], [-87.6725614847436, 42.054816184869516], [-87.67256252839275, 42.054816754830355], [-87.67256359254228, 42.054817303333266], [-87.67256467639807, 42.05481782996891], [-87.67256577915131, 42.054818334344304], [-87.67256345650539, 42.05482124323898]]]}, "properties": {"kind": "view-zone", "height": 3.5, "label": "Fountain 1", "radiusMin": 3.92079511768619, "radiusMax": 4.296777568472878, "bearing": 48.755391838982234}}, {"type": "Feature", "geometry": {"type": "Polygon", "coordinates": [[[-87.67254250109535, 42.05484748789687], [-87.67254033851376, 42.0548464987788], [-87.6725382129915, 42.05484546600674], [-87.67253612611478, 42.05484439035135], [-87.67253407944087, 42.054843272615344], [-87.67253207449708, 42.054842113632795], [-87.6725301127796, 42.05484091426861], [-87.6725281957523, 42.05483967541781], [-87.67252632484576, 42.05483839800485], [-87.67252450145612, 42.054837082982985], [-87.67252272694407, 42.054835731333554], [-87.6725210026338, 42.0548343440652], [-87.67251932981208, 42.05483292221315], [-87.67251770972719, 42.054831466838465], [-87.67251614358813, 42.05482997902718], [-87.6725146325636, 42.05482845988956], [-87.67251317778118, 42.05482691055927], [-87.67251178032649, 42.054825332192465], [-87.67251044124235, 42.054823725966976], [-87.67250916152804, 42.05482209308144], [-87.67250794213852, 42.05482043475438], [-87.67250678398375, 42.054818752223284], [-87.67250568792798, 42.05481704674375], [-87.67250465478912, 42.05481531958846], [-87.67251212278428, 42.05481292903536], [-87.67251306552018, 42.05481450505871], [-87.67251406566753, 42.054816061303], [-87.67251512248, 42.05481759660692], [-87.67251623516896, 42.05481910982473], [-87.67251740290409, 42.05482059982724], [-87.67251862481397, 42.054822065502535], [-87.67251989998677, 42.05482350575688], [-87.67252122747092, 42.0548249195155], [-87.67252260627579, 42.054826305723395], [-87.67252403537249, 42.05482766334612], [-87.67252551369455, 42.054828991370556], [-87.6725270401388, 42.0548302888057], [-87.67252861356614, 42.054831554683346], [-87.67253023280246, 42.05483278805883], [-87.67253189663938, 42.054833988011794], [-87.67253360383529, 42.05483515364675], [-87.67253535311623, 42.05483628409388], [-87.67253714317683, 42.05483737850959], [-87.67253897268125, 42.05483843607719], [-87.67254084026426, 42.05483945600748], [-87.6725427445322, 42.05484043753934], [-87.67254468406402, 42.054841379940314], [-87.67254665741238, 42.05484228250716], [-87.67254250109535, 42.05484748789687]]]}, "properties": {"kind": "view-zone", "height": 5.0, "label": "Fountain 1", "radiusMin": 7.0161596842805505, "radiusMax": 7.688970385688309, "bearing": 48.755391838982234}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [-87.672849, 42.054573]}, "properties": {"kind": "fountain", "label": "Fountain 2"}}, {"type": "Feature", "geometry": {"type": "Polygon", "coordinates": [[[-87.67284341191701, 42.05457999857741], [-87.67284315749664, 42.05457988221067], [-87.67284290743616, 42.05457976070816], [-87.67284266192218, 42.05457963416057], [-87.67284242113791, 42.054579502662314], [-87.67284218526304, 42.05457936631152], [-87.67284195447358, 42.054579225209956], [-87.67284172894176, 42.0545790794629], [-87.67284150883587, 42.054578929179115], [-87.67284129432018, 42.05457877447077], [-87.67284108555475, 42.05457861545328], [-87.67284088269538, 42.05457845224534], [-87.67284068589345, 42.05457828496872], [-87.67284049529583, 42.05457811374826], [-87.67284031104472, 42.054577938711745], [-87.67284013327765, 42.05457775998977], [-87.67283996212727, 42.054577577715705], [-87.67283979772125, 42.05457739202558], [-87.67283964018236, 42.05457720305797], [-87.67283948962809, 42.054577010953864], [-87.67283934617083, 42.05457681585665], [-87.67283920991763, 42.0545766179119], [-87.67283908097015, 42.05457641726731], [-87.67283895942461, 42.05457621407265], [-87.67283983800868, 42.05457593283054], [-87.67283994891858, 42.054576118244995], [-87.67284006658271, 42.05457630133251], [-87.67284019091332, 42.054576481956424], [-87.67284032181759, 42.05457665998199], [-87.67284045919784, 42.05457683527633], [-87.67284060295157, 42.05457700770863], [-87.6728407529715, 42.05457717715026], [-87.67284090914565, 42.05457734347472], [-87.67284107135751, 42.054577506557926], [-87.67284123948602, 42.054577666278156], [-87.67284141340573, 42.05457782251625], [-87.67284159298683, 42.0545779751556], [-87.67284177809532, 42.054578124082305], [-87.67284196859306, 42.05457826918522], [-87.67284216433792, 42.05457841035607], [-87.6728423651838, 42.05457854748952], [-87.67284257098083, 42.05457868048321], [-87.67284278157544, 42.054578809237924], [-87.67284299681047, 42.05457893365755], [-87.6728432165253, 42.05457905364927], [-87.67284344055598, 42.054579169123535], [-87.67284366873533, 42.05457927999417], [-87.67284390089307, 42.05457938617842], [-87.67284341191701, 42.05457999857741]]]}, "properties": {"kind": "view-zone", "height": 2.0, "label": "Fountain 2", "radiusMin": 0.8254305510918294, "radiusMax": 0.9045847512574479, "bearing": 48.755391838982234}}, {"type": "Feature", "geometry": {"type": "Polygon", "coordinates": [[[-87.67282245659491, 42.05460624324024], [-87.6728212480978, 42.05460569049799], [-87.67282006031026, 42.054605113360864], [-87.6728188941186, 42.05460451225952], [-87.67281775039314, 42.05460388764256], [-87.67281662998731, 42.054603239976075], [-87.67281553373725, 42.05460256974337], [-87.672814462461, 42.054601877444604], [-87.672813416958, 42.05460116359641], [-87.67281239800842, 42.05460042873148], [-87.67281140637266, 42.05459967339818], [-87.6728104427907, 42.054598898160215], [-87.67280950798163, 42.05459810359605], [-87.67280860264302, 42.05459729029864], [-87.67280772745043, 42.0545964588749], [-87.67280688305704, 42.05459560994527], [-87.6728060700929, 42.05459474414325], [-87.6728052891647, 42.054593862114935], [-87.6728045408552, 42.054592964518534], [-87.6728038257228, 42.05459205202386], [-87.67280314430118, 42.054591125311845], [-87.67280249709883, 42.05459018507406], [-87.67280188459873, 42.05458923201211], [-87.67280130725791, 42.05458826683725], [-87.67280548053374, 42.05458693093857], [-87.67280600735533, 42.05458781165738], [-87.67280656625968, 42.05458868132319], [-87.6728071568297, 42.05458953928699], [-87.67280777862467, 42.054590384908565], [-87.67280843118061, 42.054591217556876], [-87.67280911401055, 42.05459203661056], [-87.67280982660495, 42.054592841458415], [-87.67281056843201, 42.054593631499834], [-87.67281133893819, 42.05459440614525], [-87.67281213754848, 42.0545951648166], [-87.67281296366696, 42.05459590694773], [-87.67281381667712, 42.05459663198483], [-87.67281469594242, 42.054597339386866], [-87.67281560080671, 42.05459802862594], [-87.67281653059479, 42.05459869918769], [-87.67281748461276, 42.05459935057175], [-87.67281846214874, 42.054599982292025], [-87.67281946247324, 42.0546005938771], [-87.67282048483976, 42.05460118487057], [-87.6728215284854, 42.05460175483143], [-87.67282259263135, 42.054602303334356], [-87.67282367648347, 42.05460282997003], [-87.672824779233, 42.054603334345444], [-87.67282245659491, 42.05460624324024]]]}, "properties": {"kind": "view-zone", "height": 3.5, "label": "Fountain 2", "radiusMin": 3.92079511768619, "radiusMax": 4.296777568472878, "bearing": 48.755391838982234}}, {"type": "Feature", "geometry": {"type": "Polygon", "coordinates": [[[-87.67280150125555, 42.0546324878991], [-87.67279933868124, 42.05463149878101], [-87.67279721316618, 42.05463046600889], [-87.67279512629648, 42.05462939035347], [-87.67279307962947, 42.05462827261741], [-87.67279107469246, 42.05462711363482], [-87.67278911298156, 42.05462591427061], [-87.67278719596075, 42.05462467541975], [-87.67278532506052, 42.05462339800673], [-87.67278350167703, 42.05462208298482], [-87.67278172717096, 42.05462073133535], [-87.67278000286652, 42.054619344066936], [-87.67277833005042, 42.05461792221483], [-87.672776709971, 42.05461646684008], [-87.67277514383721, 42.054614979028756], [-87.6727736328178, 42.054613459891094], [-87.67277217804029, 42.05461191056073], [-87.6727707805903, 42.05461033219385], [-87.67276944151068, 42.054608725968315], [-87.67276816180068, 42.05460709308272], [-87.67276694241528, 42.054605434755594], [-87.6727657842644, 42.05460375222444], [-87.67276468821234, 42.05460204674484], [-87.67276365507696, 42.054600319589476], [-87.67277112304694, 42.05459792903629], [-87.67277206577965, 42.054599505059706], [-87.67277306592362, 42.05460106130406], [-87.67277412273253, 42.054602596608014], [-87.67277523541775, 42.054604109825895], [-87.67277640314894, 42.054605599828456], [-87.67277762505469, 42.0546070655038], [-87.6727789002232, 42.0546085057582], [-87.67278022770287, 42.054609919516885], [-87.6727816065031, 42.05461130572483], [-87.67278303559497, 42.0546126633476], [-87.67278451391205, 42.05461399137209], [-87.67278604035114, 42.05461528880729], [-87.6727876137732, 42.05461655468497], [-87.67278923300402, 42.05461778806051], [-87.67279089683534, 42.054618988013516], [-87.6727926040255, 42.05462015364852], [-87.67279435330055, 42.054621284095695], [-87.6727961433551, 42.054622378511446], [-87.67279797285336, 42.05462343607908], [-87.67279984043006, 42.05462445600939], [-87.67280174469158, 42.0546254375413], [-87.67280368421686, 42.05462637994232], [-87.67280565755856, 42.05462728250919], [-87.67280150125555, 42.0546324878991]]]}, "properties": {"kind": "view-zone", "height": 5.0, "label": "Fountain 2", "radiusMin": 7.0161596842805505, "radiusMax": 7.688970385688309, "bearing": 48.755391838982234}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [-87.673108, 42.05471]}, "properties": {"kind": "fountain", "label": "Fountain 3"}}, {"type": "Feature", "geometry": {"type": "Polygon", "coordinates": [[[-87.673102411905, 42.05471699857724], [-87.67310215748408, 42.05471688221051], [-87.67310190742306, 42.05471676070801], [-87.67310166190856, 42.054716634160414], [-87.67310142112377, 42.05471650266216], [-87.6731011852484, 42.054716366311375], [-87.67310095445843, 42.05471622520981], [-87.67310072892613, 42.05471607946275], [-87.67310050881977, 42.054715929178975], [-87.67310029430362, 42.05471577447063], [-87.67310008553774, 42.054715615453155], [-87.67309988267793, 42.054715452245205], [-87.67309968587558, 42.0547152849686], [-87.67309949527755, 42.054715113748145], [-87.67309931102605, 42.05471493871163], [-87.67309913325859, 42.05471475998966], [-87.67309896210783, 42.0547145777156], [-87.67309879770148, 42.05471439202548], [-87.67309864016224, 42.05471420305787], [-87.67309848960767, 42.054714010953774], [-87.67309834615008, 42.054713815856566], [-87.67309820989658, 42.05471361791181], [-87.67309808094883, 42.05471341726723], [-87.67309795940304, 42.05471321407257], [-87.67309883798899, 42.05471293283047], [-87.67309894889912, 42.054713118244926], [-87.67309906656352, 42.05471330133243], [-87.67309919089439, 42.05471348195634], [-87.67309932179894, 42.0547136599819], [-87.67309945917948, 42.05471383527624], [-87.67309960293353, 42.054714007708554], [-87.67309975295376, 42.05471417715016], [-87.67309990912827, 42.054714343474615], [-87.67310007134047, 42.05471450655782], [-87.67310023946933, 42.05471466627806], [-87.67310041338942, 42.05471482251614], [-87.6731005929709, 42.054714975155484], [-87.6731007780798, 42.05471512408218], [-87.67310096857796, 42.05471526918509], [-87.67310116432323, 42.05471541035595], [-87.67310136516954, 42.05471554748938], [-87.67310157096702, 42.05471568048308], [-87.67310178156207, 42.054715809237784], [-87.67310199679757, 42.05471593365743], [-87.67310221651287, 42.05471605364914], [-87.67310244054403, 42.054716169123395], [-87.67310266872387, 42.054716279994025], [-87.67310290088211, 42.05471638617828], [-87.673102411905, 42.05471699857724]]]}, "properties": {"kind": "view-zone", "height": 2.0, "label": "Fountain 3", "radiusMin": 0.8254305510918294, "radiusMax": 0.9045847512574479, "bearing": 48.755391838982234}}, {"type": "Feature", "geometry": {"type": "Polygon", "coordinates": [[[-87.67308145653787, 42.05474324323944], [-87.67308024803816, 42.054742690497214], [-87.67307906024806, 42.05474211336009], [-87.6730778940539, 42.05474151225877], [-87.67307675032596, 42.05474088764183], [-87.67307562991775, 42.054740239975345], [-87.67307453366533, 42.05473956974266], [-87.67307346238678, 42.05473887744392], [-87.67307241688152, 42.05473816359575], [-87.67307139792976, 42.054737428730824], [-87.67307040629187, 42.05473667339755], [-87.67306944270784, 42.05473589815959], [-87.67306850789676, 42.054735103595455], [-87.67306760255619, 42.054734290298065], [-87.67306672736173, 42.05473345887435], [-87.67306588296651, 42.05473260994473], [-87.67306507000063, 42.054731744142735], [-87.67306428907077, 42.05473086211444], [-87.67306354075966, 42.05472996451805], [-87.67306282562572, 42.0547290520234], [-87.67306214420263, 42.05472812531142], [-87.67306149699888, 42.054727185073645], [-87.67306088449746, 42.05472623201173], [-87.67306030715541, 42.05472526683689], [-87.67306448044022, 42.05472393093824], [-87.67306500726295, 42.05472481165703], [-87.67306556616848, 42.05472568132281], [-87.67306615673976, 42.0547265392866], [-87.67306677853608, 42.054727384908155], [-87.67306743109343, 42.054728217556445], [-87.67306811392483, 42.05472903661011], [-87.67306882652075, 42.054729841457956], [-87.67306956834942, 42.05473063149934], [-87.67307033885726, 42.05473140614474], [-87.67307113746926, 42.05473216481608], [-87.6730719635895, 42.054732906947194], [-87.67307281660149, 42.05473363198427], [-87.6730736958687, 42.054734339386286], [-87.67307460073494, 42.05473502862534], [-87.67307553052501, 42.054735699187084], [-87.67307648454505, 42.054736350571126], [-87.67307746208311, 42.05473698229139], [-87.67307846240975, 42.05473759387643], [-87.67307948477848, 42.054738184869905], [-87.67308052842637, 42.054738754830744], [-87.67308159257459, 42.05473930333366], [-87.67308267642906, 42.05473982996932], [-87.67308377918096, 42.05474033434472], [-87.67308145653787, 42.05474324323944]]]}, "properties": {"kind": "view-zone", "height": 3.5, "label": "Fountain 3", "radiusMin": 3.92079511768619, "radiusMax": 4.296777568472878, "bearing": 48.755391838982234}}, {"type": "Feature", "geometry": {"type": "Polygon", "coordinates": [[[-87.67306050115347, 42.05476948789768], [-87.6730583385745, 42.05476849877961], [-87.67305621305488, 42.054767466007526], [-87.6730541261807, 42.05476639035212], [-87.67305207950929, 42.05476527261609], [-87.67305007456795, 42.05476411363353], [-87.67304811285287, 42.05476291426935], [-87.67304619582792, 42.05476167541851], [-87.67304432492367, 42.054760398005534], [-87.67304250153627, 42.05475908298366], [-87.67304072702638, 42.054757731334206], [-87.67303900271823, 42.05475634406583], [-87.67303732989855, 42.05475492221376], [-87.67303570981564, 42.054753466839045], [-87.67303414367849, 42.05475197902775], [-87.67303263265583, 42.05475045989011], [-87.67303117787517, 42.05474891055981], [-87.6730297804222, 42.05474733219298], [-87.6730284413397, 42.05474572596746], [-87.67302716162695, 42.05474409308191], [-87.67302594223892, 42.05474243475482], [-87.67302478408557, 42.05474075222371], [-87.67302368803115, 42.054739046744146], [-87.67302265489354, 42.054737319588824], [-87.67303012287957, 42.054734929035696], [-87.67303106561431, 42.054736505059076], [-87.67303206576044, 42.05473806130338], [-87.67303312257161, 42.05473959660731], [-87.67303423525922, 42.05474110982515], [-87.67303540299291, 42.05474259982768], [-87.6730366249013, 42.054744065503], [-87.67303790007254, 42.05474550575737], [-87.67303922755508, 42.054746919516], [-87.67304060635826, 42.05474830572391], [-87.67304203545321, 42.054749663346655], [-87.67304351377346, 42.054750991371115], [-87.67304504021584, 42.05475228880628], [-87.67304661364126, 42.054753554683934], [-87.67304823287559, 42.05475478805944], [-87.67304989671048, 42.05475598801242], [-87.6730516039043, 42.0547571536474], [-87.6730533531831, 42.054758284094554], [-87.6730551432415, 42.05475937851027], [-87.67305697274368, 42.05476043607787], [-87.67305884032442, 42.05476145600817], [-87.67306074459002, 42.05476243754005], [-87.67306268411947, 42.05476337994104], [-87.67306465746542, 42.05476428250788], [-87.67306050115347, 42.05476948789768]]]}, "properties": {"kind": "view-zone", "height": 5.0, "label": "Fountain 3", "radiusMin": 7.0161596842805505, "radiusMax": 7.688970385688309, "bearing": 48.755391838982234}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [-87.673079, 42.054945]}, "properties": {"kind": "fountain", "label": "Fountain 4"}}, {"type": "Feature", "geometry": {"type": "Polygon", "coordinates": [[[-87.6730734118844, 42.05495199857696], [-87.67307315746255, 42.054951882210226], [-87.67307290740061, 42.05495176070773], [-87.67307266188519, 42.05495163416014], [-87.67307242109953, 42.05495150266188], [-87.67307218522328, 42.05495136631111], [-87.67307195443246, 42.05495122520955], [-87.67307172889933, 42.0549510794625], [-87.67307150879216, 42.05495092917873], [-87.67307129427522, 42.054950774470385], [-87.67307108550857, 42.05495061545292], [-87.67307088264802, 42.05495045224498], [-87.67307068584493, 42.05495028496838], [-87.6730704952462, 42.05495011374793], [-87.67307031099402, 42.05494993871143], [-87.6730701332259, 42.05494975998946], [-87.6730699620745, 42.05494957771541], [-87.67306979766757, 42.0549493920253], [-87.67306964012774, 42.054949203057696], [-87.6730694895726, 42.05494901095361], [-87.6730693461145, 42.0549488158564], [-87.6730692098605, 42.054948617911656], [-87.67306908091227, 42.054948417267106], [-87.67306895936602, 42.05494821407243], [-87.67306983795523, 42.05494793283035], [-87.67306994886576, 42.05494811824479], [-87.67307006653058, 42.05494830133228], [-87.6730701908619, 42.054948481956195], [-87.67307032176696, 42.05494865998175], [-87.67307045914801, 42.05494883527607], [-87.67307060290257, 42.05494900770838], [-87.67307075292337, 42.05494917714998], [-87.67307090909844, 42.05494934347444], [-87.67307107131124, 42.05494950655763], [-87.67307123944073, 42.05494966627787], [-87.67307141336146, 42.05494982251594], [-87.6730715929436, 42.054949975155274], [-87.67307177805317, 42.05495012408197], [-87.67307196855204, 42.05495026918488], [-87.67307216429803, 42.05495041035572], [-87.67307236514509, 42.054950547489156], [-87.67307257094332, 42.05495068048285], [-87.67307278153915, 42.05495080923754], [-87.67307299677543, 42.05495093365717], [-87.67307321649155, 42.054951053648885], [-87.67307344052354, 42.054951169123136], [-87.67307366870422, 42.054951279993766], [-87.67307390086332, 42.05495138617802], [-87.6730734118844, 42.05495199857696]]]}, "properties": {"kind": "view-zone", "height": 2.0, "label": "Fountain 4", "radiusMin": 0.8254305510918294, "radiusMax": 0.9045847512574479, "bearing": 48.755391838982234}}, {"type": "Feature", "geometry": {"type": "Polygon", "coordinates": [[[-87.67305245644002, 42.05497824323807], [-87.67305124793586, 42.05497769049586], [-87.67305006014138, 42.05497711335877], [-87.67304889394292, 42.054976512257475], [-87.67304775021077, 42.05497588764055], [-87.67304662979842, 42.0549752399741], [-87.67304553354195, 42.05497456974144], [-87.67304446225945, 42.05497387744273], [-87.67304341675035, 42.05497316359458], [-87.67304239779482, 42.0549724287297], [-87.67304140615329, 42.05497167339645], [-87.6730404425657, 42.05497089815854], [-87.67303950775117, 42.054970103594414], [-87.67303860240727, 42.054969290297066], [-87.67303772720959, 42.054968458873375], [-87.67303688281126, 42.0549676099438], [-87.67303606984237, 42.054966744141836], [-87.67303528890963, 42.054965862113576], [-87.67303454059575, 42.054964964517225], [-87.67303382545919, 42.05496405202262], [-87.67303314403358, 42.054963125310664], [-87.67303249682746, 42.05496218507293], [-87.67303188432378, 42.05496123201106], [-87.67303130697958, 42.054960266836254], [-87.67303548027978, 42.05495893093766], [-87.67303600710446, 42.05495981165642], [-87.67303656601206, 42.05496068132216], [-87.67303715658552, 42.05496153928591], [-87.67303777838413, 42.05496238490744], [-87.67303843094388, 42.054963217555695], [-87.6730391137778, 42.05496403660932], [-87.67303982637635, 42.05496484145713], [-87.67304056820775, 42.054965631498504], [-87.67304133871842, 42.05496640614386], [-87.67304213733337, 42.05496716481515], [-87.67304296345667, 42.05496790694624], [-87.6730438164718, 42.0549686319833], [-87.67304469574223, 42.05496933938528], [-87.67304560061181, 42.0549700286243], [-87.67304653040532, 42.05497069918602], [-87.67304748442886, 42.054971350570035], [-87.67304846197054, 42.054971982290276], [-87.67304946230087, 42.054972593875306], [-87.67305048467337, 42.054973184868736], [-87.6730515283251, 42.05497375482957], [-87.67305259247725, 42.05497430333246], [-87.6730536763357, 42.05497482996808], [-87.67305477909166, 42.054975334343474], [-87.67305245644002, 42.05497824323807]]]}, "properties": {"kind": "view-zone", "height": 3.5, "label": "Fountain 4", "radiusMin": 3.92079511768619, "radiusMax": 4.296777568472878, "bearing": 48.755391838982234}}, {"type": "Feature", "geometry": {"type": "Polygon", "coordinates": [[[-87.67303150097837, 42.05500448789523], [-87.67302933839144, 42.05500349877719], [-87.67302721286397, 42.055002466005156], [-87.6730251259821, 42.055001390349794], [-87.67302307930315, 42.05500027261381], [-87.67302107435442, 42.05499911363131], [-87.6730191126321, 42.05499791426717], [-87.67301719560008, 42.05499667541638], [-87.67301532468893, 42.05499539800346], [-87.67301350129482, 42.05499408298163], [-87.67301172677838, 42.05499273133224], [-87.67301000246388, 42.05499134406392], [-87.67300832963802, 42.05498992221191], [-87.67300670954914, 42.05498846683726], [-87.67300514340623, 42.05498697902602], [-87.67300363237798, 42.05498545988845], [-87.67300217759198, 42.0549839105582], [-87.67300078013385, 42.054982332191436], [-87.67299944104641, 42.05498072596599], [-87.67299816132895, 42.054979093080505], [-87.67299694193643, 42.054977434753475], [-87.6729957837788, 42.05497575222243], [-87.67299468772033, 42.05497404674294], [-87.67299365457893, 42.05497231958769], [-87.67300112259248, 42.05496992903466], [-87.67300206533069, 42.05497150505798], [-87.67300306548051, 42.05497306130223], [-87.67300412229558, 42.054974596606094], [-87.67300523498729, 42.05497610982387], [-87.67300640272529, 42.05497759982633], [-87.67300762463819, 42.05497906550159], [-87.67300889981412, 42.0549805057559], [-87.67301022730155, 42.054981919514475], [-87.67301160610982, 42.05498330572233], [-87.67301303521003, 42.05498466334502], [-87.67301451353573, 42.05498599136943], [-87.67301603998374, 42.05498728880454], [-87.67301761341497, 42.05498855468213], [-87.67301923265526, 42.054989788057604], [-87.67302089649627, 42.05499098801052], [-87.6730226036964, 42.05499215364544], [-87.67302435298164, 42.05499328409255], [-87.67302614304666, 42.054994378508226], [-87.67302797255559, 42.0549954360758], [-87.67302984014319, 42.05499645600605], [-87.67303174441582, 42.05499743753789], [-87.67303368395241, 42.054998379938844], [-87.67303565730563, 42.05499928250566], [-87.67303150097837, 42.05500448789523]]]}, "properties": {"kind": "view-zone", "height": 5.0, "label": "Fountain 4", "radiusMin": 7.0161596842805505, "radiusMax": 7.688970385688309, "bearing": 48.755391838982234}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [-87.672736, 42.054963]}, "properties": {"kind": "fountain", "label": "Fountain 5"}}, {"type": "Feature", "geometry": {"type": "Polygon", "coordinates": [[[-87.67273041188284, 42.05496999857694], [-87.67273015746089, 42.0549698822102], [-87.67272990739889, 42.05496976070771], [-87.67272966188341, 42.05496963416012], [-87.67272942109766, 42.05496950266187], [-87.67272918522136, 42.054969366311084], [-87.67272895443048, 42.054969225209526], [-87.67272872889727, 42.05496907946248], [-87.67272850879004, 42.05496892917871], [-87.67272829427303, 42.054968774470375], [-87.67272808550634, 42.0549686154529], [-87.67272788264572, 42.05496845224497], [-87.67272768584259, 42.05496828496836], [-87.67272749524379, 42.05496811374792], [-87.67272731099156, 42.05496793871141], [-87.6727271332234, 42.054967759989445], [-87.67272696207196, 42.0549675777154], [-87.67272679766496, 42.05496739202529], [-87.67272664012509, 42.054967203057686], [-87.67272648956992, 42.054967010953604], [-87.67272634611177, 42.05496681585639], [-87.67272620985773, 42.05496661791166], [-87.67272608090946, 42.054966417267096], [-87.67272595936319, 42.05496621407243], [-87.67272683795264, 42.05496593283035], [-87.6727269488632, 42.05496611824479], [-87.67272706652807, 42.054966301332286], [-87.67272719085943, 42.05496648195619], [-87.6727273217645, 42.05496665998174], [-87.67272745914559, 42.05496683527607], [-87.6727276029002, 42.05496700770838], [-87.67272775292102, 42.054967177149976], [-87.67272790909614, 42.054967343474424], [-87.67272807130901, 42.05496750655762], [-87.67272823943854, 42.054967666277854], [-87.67272841335931, 42.054967822515934], [-87.67272859294151, 42.054967975155265], [-87.67272877805114, 42.054968124081945], [-87.67272896855006, 42.054968269184855], [-87.6727291642961, 42.05496841035571], [-87.67272936514321, 42.054968547489146], [-87.6727295709415, 42.05496868048283], [-87.67272978153738, 42.05496880923753], [-87.67272999677374, 42.054968933657165], [-87.67273021648992, 42.05496905364887], [-87.67273044052197, 42.054969169123126], [-87.67273066870271, 42.05496927999374], [-87.67273090086188, 42.054969386177994], [-87.67273041188284, 42.05496999857694]]]}, "properties": {"kind": "view-zone", "height": 2.0, "label": "Fountain 5", "radiusMin": 0.8254305510918294, "radiusMax": 0.9045847512574479, "bearing": 48.755391838982234}}, {"type": "Feature", "geometry": {"type": "Polygon", "coordinates": [[[-87.67270945643253, 42.054996243237966], [-87.67270824792803, 42.054995690495765], [-87.6727070601332, 42.05499511335867], [-87.67270589393442, 42.05499451225738], [-87.67270475020194, 42.05499388764046], [-87.67270362978928, 42.054993239973996], [-87.67270253353252, 42.054992569741344], [-87.6727014622497, 42.054991877442646], [-87.6727004167403, 42.054991163594494], [-87.67269939778448, 42.05499042872961], [-87.67269840614267, 42.05498967339638], [-87.67269744255482, 42.05498889815845], [-87.67269650774003, 42.05498810359434], [-87.67269560239586, 42.05498729029699], [-87.67269472719794, 42.05498645887331], [-87.67269388279936, 42.054985609943735], [-87.67269306983025, 42.05498474414178], [-87.67269228889728, 42.05498386211352], [-87.6726915405832, 42.05498296451717], [-87.67269082544644, 42.05498205202255], [-87.67269014402063, 42.05498112531061], [-87.67268949681433, 42.05498018507289], [-87.67268888431047, 42.054979232011014], [-87.67268830696612, 42.05497826683621], [-87.67269248026749, 42.05497693093762], [-87.6726930070923, 42.05497781165638], [-87.67269356600006, 42.05497868132212], [-87.6726941565737, 42.05497953928586], [-87.67269477837249, 42.05498038490738], [-87.67269543093242, 42.05498121755564], [-87.67269611376653, 42.054982036609275], [-87.67269682636528, 42.05498284145708], [-87.67269756819688, 42.05498363149843], [-87.67269833870778, 42.05498440614379], [-87.67269913732295, 42.0549851648151], [-87.67269996344648, 42.05498590694617], [-87.67270081646187, 42.05498663198323], [-87.67270169573254, 42.054987339385214], [-87.67270260060238, 42.05498802862422], [-87.67270353039613, 42.05498869918595], [-87.67270448441997, 42.05498935056996], [-87.67270546196193, 42.05498998229019], [-87.67270646229252, 42.05499059387521], [-87.67270748466531, 42.054991184868655], [-87.67270852831734, 42.05499175482948], [-87.67270959246979, 42.05499230333236], [-87.67271067632855, 42.054992829968], [-87.67271177908482, 42.054993334343386], [-87.67270945643253, 42.054996243237966]]]}, "properties": {"kind": "view-zone", "height": 3.5, "label": "Fountain 5", "radiusMin": 3.92079511768619, "radiusMax": 4.296777568472878, "bearing": 48.755391838982234}}, {"type": "Feature", "geometry": {"type": "Polygon", "coordinates": [[[-87.67268850096495, 42.05502248789505], [-87.67268633837742, 42.05502149877702], [-87.67268421284935, 42.05502046600498], [-87.67268212596689, 42.05501939034963], [-87.67268007928736, 42.055018272613644], [-87.67267807433807, 42.05501711363113], [-87.67267611261519, 42.055015914266995], [-87.67267419558263, 42.05501467541623], [-87.67267232467096, 42.05501339800331], [-87.67267050127631, 42.055012082981484], [-87.6726687267594, 42.055010731332096], [-87.67266700244438, 42.055009344063784], [-87.67266532961807, 42.05500792221177], [-87.67266370952873, 42.05500646683713], [-87.67266214338538, 42.055004979025895], [-87.6726606323567, 42.05500345988833], [-87.67265917757028, 42.05500191055809], [-87.67265778011176, 42.05500033219133], [-87.67265644102395, 42.05499872596588], [-87.67265516130612, 42.05499709308039], [-87.67265394191325, 42.05499543475338], [-87.6726527837553, 42.05499375222235], [-87.67265168769653, 42.05499204674285], [-87.67265065455483, 42.05499031958761], [-87.6726581225705, 42.05498792903459], [-87.67265906530896, 42.0549895050579], [-87.67266006545907, 42.05499106130215], [-87.67266112227445, 42.054992596606], [-87.67266223496647, 42.054994109823774], [-87.6726634027048, 42.054995599826235], [-87.67266462461802, 42.05499706550149], [-87.67266589979432, 42.0549985057558], [-87.67266722728213, 42.054999919514366], [-87.67266860609078, 42.055001305722215], [-87.67267003519139, 42.0550026633449], [-87.67267151351751, 42.055003991369304], [-87.67267303996596, 42.05500528880441], [-87.67267461339763, 42.055006554682], [-87.67267623263838, 42.055007788057466], [-87.67267789647987, 42.05500898801038], [-87.67267960368048, 42.05501015364531], [-87.67268135296622, 42.05501128409241], [-87.67268314303173, 42.055012378508074], [-87.67268497254118, 42.05501343607564], [-87.67268684012932, 42.0550144560059], [-87.67268874440246, 42.05501543753773], [-87.67269068393962, 42.05501637993867], [-87.6726926572934, 42.05501728250549], [-87.67268850096495, 42.05502248789505]]]}, "properties": {"kind": "view-zone", "height": 5.0, "label": "Fountain 5", "radiusMin": 7.0161596842805505, "radiusMax": 7.688970385688309, "bearing": 48.755391838982234}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [-87.672833, 42.054756]}, "properties": {"kind": "fountain", "label": "Centrale"}}, {"type": "Feature", "geometry": {"type": "Polygon", "coordinates": [[[-87.67282741190097, 42.054762998577196], [-87.67282715747987, 42.05476288221045], [-87.67282690741867, 42.05476276070795], [-87.67282666190398, 42.05476263416036], [-87.67282642111903, 42.054762502662115], [-87.67282618524347, 42.05476236631132], [-87.67282595445334, 42.05476222520975], [-87.67282572892088, 42.054762079462705], [-87.67282550881437, 42.05476192917892], [-87.67282529429805, 42.054761774470585], [-87.67282508553203, 42.0547616154531], [-87.67282488267207, 42.054761452245174], [-87.67282468586959, 42.054761284968556], [-87.67282449527141, 42.05476111374811], [-87.67282431101978, 42.05476093871159], [-87.67282413325219, 42.05476075998963], [-87.6728239621013, 42.05476057771557], [-87.67282379769483, 42.05476039202545], [-87.67282364015549, 42.05476020305784], [-87.6728234896008, 42.05476001095375], [-87.67282334614312, 42.05475981585653], [-87.67282320988953, 42.054759617911785], [-87.67282308094167, 42.054759417267206], [-87.67282295939579, 42.05475921407255], [-87.67282383798238, 42.05475893283045], [-87.67282394889259, 42.0547591182449], [-87.67282406655707, 42.0547593013324], [-87.67282419088802, 42.05475948195632], [-87.67282432179267, 42.05475965998187], [-87.67282445917333, 42.0547598352762], [-87.67282460292745, 42.05476000770852], [-87.67282475294782, 42.05476017715013], [-87.67282490912243, 42.054760343474584], [-87.67282507133476, 42.054760506557784], [-87.67282523946373, 42.05476066627802], [-87.67282541338395, 42.05476082251611], [-87.67282559296555, 42.05476097515545], [-87.67282577807458, 42.05476112408215], [-87.67282596857288, 42.05476126918506], [-87.6728261643183, 42.0547614103559], [-87.67282636516475, 42.05476154748934], [-87.67282657096237, 42.05476168048304], [-87.67282678155759, 42.054761809237746], [-87.67282699679323, 42.05476193365738], [-87.6728272165087, 42.05476205364909], [-87.67282744054003, 42.05476216912334], [-87.67282766872003, 42.05476227999397], [-87.67282790087843, 42.05476238617822], [-87.67282741190097, 42.054762998577196]]]}, "properties": {"kind": "view-zone", "height": 2.0, "label": "Centrale", "radiusMin": 0.8254305510918294, "radiusMax": 0.9045847512574479, "bearing": 48.755391838982234}}, {"type": "Feature", "geometry": {"type": "Polygon", "coordinates": [[[-87.67280645651871, 42.05478924323917], [-87.67280524801814, 42.05478869049695], [-87.67280406022718, 42.054788113359834], [-87.67280289403217, 42.05478751225852], [-87.6728017503034, 42.05478688764158], [-87.67280062989438, 42.054786239975115], [-87.67279953364118, 42.05478556974242], [-87.67279846236185, 42.05478487744369], [-87.67279741685584, 42.05478416359551], [-87.67279639790334, 42.0547834287306], [-87.67279540626474, 42.05478267339734], [-87.67279444268001, 42.05478189815939], [-87.67279350786825, 42.05478110359525], [-87.67279260252704, 42.05478029029787], [-87.67279172733195, 42.05477945887416], [-87.67279088293613, 42.054778609944556], [-87.67279006996965, 42.05477774414257], [-87.67278928903922, 42.05477686211428], [-87.67278854072757, 42.0547759645179], [-87.67278782559312, 42.05477505202325], [-87.67278714416955, 42.054774125311276], [-87.67278649696533, 42.054773185073515], [-87.67278588446345, 42.0547722320116], [-87.67278530712099, 42.05477126683677], [-87.6727894804088, 42.054769930938136], [-87.67279000723191, 42.05477081165691], [-87.67279056613786, 42.05477168132269], [-87.67279115670958, 42.05477253928646], [-87.67279177850634, 42.05477338490802], [-87.67279243106414, 42.0547742175563], [-87.67279311389605, 42.05477503660997], [-87.67279382649248, 42.0547758414578], [-87.67279456832168, 42.05477663149918], [-87.67279533883007, 42.05477740614457], [-87.67279613744266, 42.0547781648159], [-87.6727969635635, 42.05477890694701], [-87.67279781657611, 42.05477963198409], [-87.67279869584394, 42.05478033938609], [-87.67279960071085, 42.054781028625136], [-87.67280053050158, 42.054781699186876], [-87.6728014845223, 42.05478235057092], [-87.67280246206109, 42.054782982291165], [-87.67280346238844, 42.05478359387622], [-87.6728044847579, 42.05478418486968], [-87.67280552840654, 42.05478475483052], [-87.67280659255555, 42.05478530333342], [-87.67280767641078, 42.05478582996908], [-87.67280877916347, 42.054786334344485], [-87.67280645651871, 42.05478924323917]]]}, "properties": {"kind": "view-zone", "height": 3.5, "label": "Centrale", "radiusMin": 3.92079511768619, "radiusMax": 4.296777568472878, "bearing": 48.755391838982234}}, {"type": "Feature", "geometry": {"type": "Polygon", "coordinates": [[[-87.6727855011192, 42.0548154878972], [-87.67278333853868, 42.05481449877914], [-87.6727812130175, 42.054813466007055], [-87.67277912614182, 42.054812390351664], [-87.67277707946894, 42.05481127261565], [-87.67277507452616, 42.05481011363311], [-87.67277311280965, 42.05480891426892], [-87.67277119578333, 42.054807675418104], [-87.67276932487772, 42.05480639800513], [-87.672767501489, 42.054805082983265], [-87.67276572697783, 42.05480373133381], [-87.67276400266843, 42.05480234406546], [-87.67276232984754, 42.0548009222134], [-87.67276070976348, 42.054799466838695], [-87.6727591436252, 42.05479797902742], [-87.67275763260143, 42.0547964598898], [-87.67275617781975, 42.054794910559494], [-87.67275478036575, 42.05479333219269], [-87.67275344128228, 42.05479172596718], [-87.67275216156862, 42.05479009308163], [-87.6727509421797, 42.054788434754556], [-87.67274978402551, 42.054786752223464], [-87.6727486879703, 42.05478504674391], [-87.67274765483195, 42.054783319588616], [-87.67275512282338, 42.0547809290355], [-87.67275606555879, 42.05478250505886], [-87.67275706570564, 42.05478406130317], [-87.67275812251758, 42.054785596607076], [-87.67275923520599, 42.05478710982491], [-87.67276040294053, 42.05478859982742], [-87.67276162484978, 42.05479006550273], [-87.67276290002195, 42.05479150575707], [-87.67276422750544, 42.054792919515705], [-87.67276560630962, 42.054794305723604], [-87.6727670354056, 42.05479566334633], [-87.67276851372692, 42.05479699137079], [-87.67277004017039, 42.05479828880594], [-87.67277161359696, 42.05479955468358], [-87.67277323283245, 42.05480078805908], [-87.67277489666854, 42.054801988012045], [-87.67277660386361, 42.05480315364702], [-87.67277835314367, 42.05480428409416], [-87.67278014320335, 42.054805378509876], [-87.67278197270686, 42.054806436077484], [-87.67278384028894, 42.05480745600776], [-87.67278574455592, 42.05480843753962], [-87.67278768408677, 42.054809379940615], [-87.67278965743414, 42.054810282507454], [-87.6727855011192, 42.0548154878972]]]}, "properties": {"kind": "view-zone", "height": 5.0, "label": "Centrale", "radiusMin": 7.0161596842805505, "radiusMax": 7.688970385688309, "bearing": 48.755391838982234}}, {"type": "Feature", "geometry": {"type": "LineString", "coordinates": [[-87.672833, 42.054756], [-87.67919080297055, 42.05060101478059]]}, "properties": {"kind": "sun-line"}}]};
        const metadata = {"title": "Rainbow Visibility", "sunAltitude": 16.145376542764218, "sunAzimuth": 228.75539183898223, "sunrise": "2025-11-07T06:31:29.878059-06:00", "sunset": "2025-11-07T16:36:42.447833-06:00", "generatedAt": "2025-11-07T14:50:00-06:00", "eyeHeight": 1.6, "dropletHeights": [2.0, 3.5, 5.0], "thetaRange": [40.0, 42.0]};

        const map = new maplibregl.Map({
            container: 'map',
            style: 'https://basemaps.cartocdn.com/gl/positron-gl-style/style.json',
            center: [-87.672833, 42.054756],
            zoom: 17
        });

        map.addControl(new maplibregl.NavigationControl({ visualizePitch: true }));

        map.on('load', () => {
            map.addSource('rainbow', {
                type: 'geojson',
                data: geojson
            });

            map.addLayer({
                id: 'viewing-zone-fill',
                type: 'fill',
                source: 'rainbow',
                filter: ['==', ['get', 'kind'], 'view-zone'],
                paint: {
                    'fill-color': [
                        'interpolate',
                        ['linear'],
                        ['get', 'height'],
                        1.0, '#34d399',
                        3.0, '#fbbf24',
                        5.0, '#f472b6'
                    ],
                    'fill-opacity': 0.35
                }
            });

            map.addLayer({
                id: 'viewing-zone-outline',
                type: 'line',
                source: 'rainbow',
                filter: ['==', ['get', 'kind'], 'view-zone'],
                paint: {
                    'line-color': '#0ea5e9',
                    'line-width': 1.5
                }
            });

            map.addLayer({
                id: 'sun-direction',
                type: 'line',
                source: 'rainbow',
                filter: ['==', ['get', 'kind'], 'sun-line'],
                paint: {
                    'line-color': '#facc15',
                    'line-width': 4
                }
            });

            map.addLayer({
                id: 'fountains',
                type: 'circle',
                source: 'rainbow',
                filter: ['==', ['get', 'kind'], 'fountain'],
                paint: {
                    'circle-radius': 5,
                    'circle-color': '#38bdf8',
                    'circle-stroke-color': '#0f172a',
                    'circle-stroke-width': 1.5
                }
            });

            map.addLayer({
                id: 'fountain-labels',
                type: 'symbol',
                source: 'rainbow',
                filter: ['==', ['get', 'kind'], 'fountain'],
                layout: {
                    'text-field': ['get', 'label'],
                    'text-size': 12,
                    'text-offset': [0, 1.2]
                },
                paint: {
                    'text-color': '#e2e8f0',
                    'text-halo-color': '#0f172a',
                    'text-halo-width': 1
                }
            });
        });

        const infoPanel = document.getElementById('info-panel');
        const sunrise = new Date(metadata.sunrise).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
        const sunset = new Date(metadata.sunset).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
        const generated = new Date(metadata.generatedAt).toLocaleString();
        infoPanel.innerHTML = `
            <h1>${metadata.title}</h1>
            <div><strong>Sun altitude:</strong> ${metadata.sunAltitude.toFixed(2)}°</div>
            <div><strong>Sun azimuth:</strong> ${metadata.sunAzimuth.toFixed(2)}°</div>
            <div><strong>Eye height:</strong> ${metadata.eyeHeight.toFixed(2)} m</div>
            <div><strong>Droplet heights:</strong> ${metadata.dropletHeights.join(', ')} m</div>
            <div><strong>Sunrise / Sunset:</strong> ${sunrise} / ${sunset}</div>
            <div><strong>Generated:</strong> ${generated}</div>
            <div class="legend">
                <span class="legend-item"><span class="swatch sun"></span>Sun ray</span>
                <span class="legend-item"><span class="swatch zone"></span>Viewing band</span>
                <span class="legend-item"><span class="swatch edge"></span>Band outline</span>
            </div>
        `;
    </script>
</body>
</html>
